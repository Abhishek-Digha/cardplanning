{"ast":null,"code":"import React from'react';import{useSession}from'../contexts/SessionContext';import{sessionAPI}from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AdminControls(){var _session$members,_session$members2;const[customNumber,setCustomNumber]=React.useState(\"\");const[updating,setUpdating]=React.useState(false);const{session,user,activeStory,isRevealed,dispatch,votes,voteCount,totalMembers}=useSession();// Calculate vote count and total members for the current active story\n// Prevent rendering if required data is missing\nif(!session||!user||!activeStory)return null;// Calculate vote status for each member\nconst memberCount=(session===null||session===void 0?void 0:(_session$members=session.members)===null||_session$members===void 0?void 0:_session$members.length)||0;const submittedCount=(session===null||session===void 0?void 0:(_session$members2=session.members)===null||_session$members2===void 0?void 0:_session$members2.filter(m=>votes&&votes[m.id]!==undefined).length)||0;return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'center',width:'100%',padding:'2vw 0',minHeight:0},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',borderRadius:16,boxShadow:'0 4px 24px rgba(0,0,0,0.10)',padding:'2.5rem 2vw 2rem 2vw',width:'100%',maxWidth:520,border:'1px solid #e0e7ef',marginBottom:32,marginTop:8,transition:'box-shadow 0.2s'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:22},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:700,fontSize:'1.25rem',color:'#2d3a4a',letterSpacing:0.5},children:\"Voting Status\"}),/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:600,fontSize:'1.08rem',color:'#1976d2',textAlign:'right',background:'#e3f0fc',borderRadius:8,padding:'4px 14px',minWidth:120,display:'inline-block'},children:[\"Votes: \",submittedCount,\"/\",memberCount]})]}),/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'separate',borderSpacing:0,background:'white',borderRadius:12,overflow:'hidden',boxShadow:'0 1px 8px rgba(0,0,0,0.04)'},children:[/*#__PURE__*/_jsx(\"thead\",{style:{background:'#f3f6fa'},children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'13px 16px',textAlign:'left',color:'#2d3a4a',fontWeight:700,borderBottom:'2px solid #e0e7ef',fontSize:'1.08rem'},children:\"Member\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'13px 16px',textAlign:'center',color:'#2d3a4a',fontWeight:700,borderBottom:'2px solid #e0e7ef',fontSize:'1.08rem'},children:\"Voted\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:session.members&&session.members.map((member,idx)=>/*#__PURE__*/_jsxs(\"tr\",{style:{background:idx%2===0?'#f8fafc':'#fff'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'13px 16px',borderBottom:'1px solid #f3f6fa',fontSize:'1.07rem',fontWeight:500},children:member.name||member.username||member.id}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'13px 16px',textAlign:'center',borderBottom:'1px solid #f3f6fa',fontSize:'1.07rem'},children:votes&&votes[member.id]!==undefined?/*#__PURE__*/_jsx(\"span\",{style:{color:'#22c55e',fontWeight:700,fontSize:'1.25rem'},children:\"\\u2714\"}):/*#__PURE__*/_jsx(\"span\",{style:{color:'#ef4444',fontWeight:700,fontSize:'1.25rem'},children:\"\\u2717\"})})]},member.id))})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{var _updatedSession$stori;await sessionAPI.revealVotes(session.id,activeStory.id,user.id);// Fetch updated session to get revealed state and votes\nconst updatedSession=await sessionAPI.getSession(session.id);// Update votes and isRevealed in context\ndispatch({type:'SET',payload:{votes:((_updatedSession$stori=updatedSession.stories.find(s=>s.id===activeStory.id))===null||_updatedSession$stori===void 0?void 0:_updatedSession$stori.votes)||{},isRevealed:true}});},disabled:isRevealed,style:{padding:'12px 32px',background:isRevealed?'#a3a3a3':'linear-gradient(90deg, #1976d2 0%, #43a047 100%)',color:'#fff',border:'none',borderRadius:8,cursor:isRevealed?'not-allowed':'pointer',fontWeight:'bold',fontSize:19,marginTop:'0.5rem',marginBottom:'0.5rem',boxShadow:'0 2px 8px rgba(25,118,210,0.10)'},children:isRevealed?'Revealed':'Reveal'})]});}","map":{"version":3,"names":["React","useSession","sessionAPI","jsx","_jsx","jsxs","_jsxs","AdminControls","_session$members","_session$members2","customNumber","setCustomNumber","useState","updating","setUpdating","session","user","activeStory","isRevealed","dispatch","votes","voteCount","totalMembers","memberCount","members","length","submittedCount","filter","m","id","undefined","style","display","flexDirection","alignItems","width","padding","minHeight","children","background","borderRadius","boxShadow","maxWidth","border","marginBottom","marginTop","transition","justifyContent","fontWeight","fontSize","color","letterSpacing","textAlign","minWidth","borderCollapse","borderSpacing","overflow","borderBottom","map","member","idx","name","username","onClick","_updatedSession$stori","revealVotes","updatedSession","getSession","type","payload","stories","find","s","disabled","cursor"],"sources":["C:/Users/abhis/Downloads/story-pointing-app/frontend/src/components/AdminControls.js"],"sourcesContent":["import React from 'react';\r\nimport { useSession } from '../contexts/SessionContext';\r\nimport { sessionAPI } from '../utils/api';\r\nexport default function AdminControls(){\r\n  const [customNumber, setCustomNumber] = React.useState(\"\");\r\n  const [updating, setUpdating] = React.useState(false);\r\n  const {session,user,activeStory,isRevealed,dispatch,votes,voteCount,totalMembers} = useSession();\r\n  // Calculate vote count and total members for the current active story\r\n\r\n  // Prevent rendering if required data is missing\r\n  if (!session || !user || !activeStory) return null;\r\n\r\n  // Calculate vote status for each member\r\n  const memberCount = session?.members?.length || 0;\r\n  const submittedCount = session?.members?.filter(m => votes && votes[m.id] !== undefined).length || 0;\r\n\r\n  return (\r\n    <div style={{\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      alignItems: 'center',\r\n      width: '100%',\r\n      padding: '2vw 0',\r\n      minHeight: 0,\r\n    }}>\r\n      <div style={{\r\n        background: '#fff',\r\n        borderRadius: 16,\r\n        boxShadow: '0 4px 24px rgba(0,0,0,0.10)',\r\n        padding: '2.5rem 2vw 2rem 2vw',\r\n        width: '100%',\r\n        maxWidth: 520,\r\n        border: '1px solid #e0e7ef',\r\n        marginBottom: 32,\r\n        marginTop: 8,\r\n        transition: 'box-shadow 0.2s',\r\n      }}>\r\n        <div style={{display:'flex', justifyContent:'space-between', alignItems:'center', marginBottom:22}}>\r\n          <span style={{fontWeight: 700, fontSize: '1.25rem', color: '#2d3a4a', letterSpacing: 0.5}}>Voting Status</span>\r\n          <span style={{fontWeight:600, fontSize:'1.08rem', color:'#1976d2', textAlign:'right', background:'#e3f0fc', borderRadius:8, padding:'4px 14px', minWidth:120, display:'inline-block'}}>Votes: {submittedCount}/{memberCount}</span>\r\n        </div>\r\n        <table style={{width: '100%', borderCollapse: 'separate', borderSpacing: 0, background: 'white', borderRadius: 12, overflow: 'hidden', boxShadow: '0 1px 8px rgba(0,0,0,0.04)'}}>\r\n          <thead style={{background: '#f3f6fa'}}>\r\n            <tr>\r\n              <th style={{padding: '13px 16px', textAlign: 'left', color: '#2d3a4a', fontWeight: 700, borderBottom: '2px solid #e0e7ef', fontSize: '1.08rem'}}>Member</th>\r\n              <th style={{padding: '13px 16px', textAlign: 'center', color: '#2d3a4a', fontWeight: 700, borderBottom: '2px solid #e0e7ef', fontSize: '1.08rem'}}>Voted</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {session.members && session.members.map((member, idx) => (\r\n              <tr key={member.id} style={{background: idx % 2 === 0 ? '#f8fafc' : '#fff'}}>\r\n                <td style={{padding: '13px 16px', borderBottom: '1px solid #f3f6fa', fontSize: '1.07rem', fontWeight: 500}}>{member.name || member.username || member.id}</td>\r\n                <td style={{padding: '13px 16px', textAlign: 'center', borderBottom: '1px solid #f3f6fa', fontSize: '1.07rem'}}>\r\n                  {votes && votes[member.id] !== undefined ? <span style={{color: '#22c55e', fontWeight: 700, fontSize: '1.25rem'}}>✔</span> : <span style={{color: '#ef4444', fontWeight: 700, fontSize: '1.25rem'}}>✗</span>}\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      <button\r\n        onClick={async ()=>{\r\n          await sessionAPI.revealVotes(session.id,activeStory.id,user.id);\r\n          // Fetch updated session to get revealed state and votes\r\n          const updatedSession = await sessionAPI.getSession(session.id);\r\n          // Update votes and isRevealed in context\r\n          dispatch({type:'SET',payload:{votes: updatedSession.stories.find(s=>s.id===activeStory.id)?.votes || {}, isRevealed: true}});\r\n        }}\r\n        disabled={isRevealed}\r\n        style={{\r\n          padding:'12px 32px',\r\n          background: isRevealed ? '#a3a3a3' : 'linear-gradient(90deg, #1976d2 0%, #43a047 100%)',\r\n          color:'#fff',\r\n          border:'none',\r\n          borderRadius:8,\r\n          cursor: isRevealed ? 'not-allowed' : 'pointer',\r\n          fontWeight:'bold',\r\n          fontSize:19,\r\n          marginTop:'0.5rem',\r\n          marginBottom:'0.5rem',\r\n          boxShadow:'0 2px 8px rgba(25,118,210,0.10)'\r\n        }}\r\n      >\r\n        {isRevealed ? 'Revealed' : 'Reveal'}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}