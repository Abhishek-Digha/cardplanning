{"ast":null,"code":"import React,{useState}from'react';import{useSession}from'../contexts/SessionContext';import{sessionAPI}from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function StoryManager(){const{session,user,stories,activeStory,dispatch}=useSession();const[open,setOpen]=useState(false);const[title,setTitle]=useState('');const[desc,setDesc]=useState('');const handle=async e=>{e.preventDefault();if(!title)return;await sessionAPI.createStory(session.id,title,desc,user.id);// Do not update context here; rely on socket event for real-time update\nsetTitle('');setDesc('');setOpen(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"story-manager\",children:[user.isAdmin&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:16,textAlign:'center'},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setOpen(!open),style:{padding:'10px 24px',background:'#1976d2',color:'#fff',border:'none',borderRadius:4,cursor:'pointer',fontWeight:'bold',fontSize:18,marginBottom:8},children:\"+ Create Card\"})}),open&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handle,style:{background:'#f5f5f5',padding:20,borderRadius:8,margin:'16px 0',boxShadow:'0 2px 8px #0001',maxWidth:400,marginLeft:'auto',marginRight:'auto'},children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:12},children:/*#__PURE__*/_jsx(\"input\",{placeholder:\"Title\",value:title,onChange:e=>setTitle(e.target.value),style:{width:'100%',padding:8,fontSize:16,borderRadius:4,border:'1px solid #ccc'},required:true})}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:12},children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Description\",value:desc,onChange:e=>setDesc(e.target.value),style:{width:'100%',padding:8,fontSize:15,borderRadius:4,border:'1px solid #ccc',minHeight:60}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'flex-end',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setOpen(false),style:{padding:'6px 16px',background:'#eee',border:'none',borderRadius:4,cursor:'pointer'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{padding:'6px 16px',background:'#43a047',color:'#fff',border:'none',borderRadius:4,cursor:'pointer',fontWeight:'bold'},children:\"Create\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between'},children:/*#__PURE__*/_jsx(\"h3\",{children:\"Stories\"})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:stories.map(s=>/*#__PURE__*/_jsxs(\"div\",{className:`story-item ${(activeStory===null||activeStory===void 0?void 0:activeStory.id)===s.id?'active':''}`,style:{background:(activeStory===null||activeStory===void 0?void 0:activeStory.id)===s.id?'#e3f2fd':'#fff',border:'1px solid #ddd',borderRadius:6,padding:'10px 16px',marginBottom:10,boxShadow:(activeStory===null||activeStory===void 0?void 0:activeStory.id)===s.id?'0 2px 8px #1976d233':'0 1px 2px #0001',cursor:'pointer',transition:'box-shadow 0.2s',position:'relative'},onClick:async()=>{// Fetch latest session to get up-to-date members and story state\nconst updatedSession=await sessionAPI.getSession(session.id);const latestStory=updatedSession.stories.find(st=>st.id===s.id)||s;dispatch({type:'SET_ACTIVE',payload:latestStory});dispatch({type:'SET',payload:{votes:latestStory.votes||{},isRevealed:!!latestStory.isRevealed,session:{...session,members:updatedSession.members}}});},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 4px 0',fontWeight:600},children:s.title}),s.description&&/*#__PURE__*/_jsx(\"p\",{style:{margin:0,color:'#555'},children:s.description}),(activeStory===null||activeStory===void 0?void 0:activeStory.id)===s.id&&/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',top:10,right:16,background:'#1976d2',color:'#fff',padding:'2px 8px',borderRadius:4,fontSize:12},children:\"Active\"})]},s.id))})]});}","map":{"version":3,"names":["React","useState","useSession","sessionAPI","jsx","_jsx","jsxs","_jsxs","StoryManager","session","user","stories","activeStory","dispatch","open","setOpen","title","setTitle","desc","setDesc","handle","e","preventDefault","createStory","id","className","children","isAdmin","style","marginBottom","textAlign","onClick","padding","background","color","border","borderRadius","cursor","fontWeight","fontSize","onSubmit","margin","boxShadow","maxWidth","marginLeft","marginRight","placeholder","value","onChange","target","width","required","minHeight","display","justifyContent","gap","type","alignItems","marginTop","map","s","transition","position","updatedSession","getSession","latestStory","find","st","payload","votes","isRevealed","members","description","top","right"],"sources":["C:/Users/abhis/Downloads/story-pointing-app/frontend/src/components/StoryManager.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useSession } from '../contexts/SessionContext';\r\nimport { sessionAPI } from '../utils/api';\r\n\r\nexport default function StoryManager(){\r\n  const {session,user,stories,activeStory,dispatch} = useSession();\r\n  const [open,setOpen]=useState(false);\r\n  const [title,setTitle]=useState('');\r\n  const [desc,setDesc]=useState('');\r\n\r\n  const handle = async e=>{\r\n    e.preventDefault();\r\n    if(!title) return;\r\n    await sessionAPI.createStory(session.id,title,desc,user.id);\r\n    // Do not update context here; rely on socket event for real-time update\r\n    setTitle('');setDesc('');setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"story-manager\">\r\n      {user.isAdmin && (\r\n        <div style={{marginBottom: 16, textAlign: 'center'}}>\r\n          <button \r\n            onClick={()=>setOpen(!open)}\r\n            style={{padding:'10px 24px',background:'#1976d2',color:'#fff',border:'none',borderRadius:4,cursor:'pointer',fontWeight:'bold',fontSize:18,marginBottom:8}}\r\n          >\r\n            + Create Card\r\n          </button>\r\n        </div>\r\n      )}\r\n      {open && (\r\n        <form onSubmit={handle} style={{background:'#f5f5f5',padding:20,borderRadius:8,margin:'16px 0',boxShadow:'0 2px 8px #0001',maxWidth:400,marginLeft:'auto',marginRight:'auto'}}>\r\n          <div style={{marginBottom:12}}>\r\n            <input \r\n              placeholder=\"Title\"\r\n              value={title}\r\n              onChange={e=>setTitle(e.target.value)}\r\n              style={{width:'100%',padding:8,fontSize:16,borderRadius:4,border:'1px solid #ccc'}}\r\n              required\r\n            />\r\n          </div>\r\n          <div style={{marginBottom:12}}>\r\n            <textarea\r\n              placeholder=\"Description\"\r\n              value={desc}\r\n              onChange={e=>setDesc(e.target.value)}\r\n              style={{width:'100%',padding:8,fontSize:15,borderRadius:4,border:'1px solid #ccc',minHeight:60}}\r\n            />\r\n          </div>\r\n          <div style={{display:'flex',justifyContent:'flex-end',gap:8}}>\r\n            <button type=\"button\" onClick={()=>setOpen(false)} style={{padding:'6px 16px',background:'#eee',border:'none',borderRadius:4,cursor:'pointer'}}>Cancel</button>\r\n            <button type=\"submit\" style={{padding:'6px 16px',background:'#43a047',color:'#fff',border:'none',borderRadius:4,cursor:'pointer',fontWeight:'bold'}}>Create</button>\r\n          </div>\r\n        </form>\r\n      )}\r\n      <div style={{display:'flex',alignItems:'center',justifyContent:'space-between'}}>\r\n        <h3>Stories</h3>\r\n      </div>\r\n      <div style={{marginTop:12}}>\r\n        {stories.map(s=>(\r\n          <div \r\n            key={s.id} \r\n            className={`story-item ${activeStory?.id===s.id?'active':''}`}\r\n            style={{\r\n              background:activeStory?.id===s.id?'#e3f2fd':'#fff',\r\n              border:'1px solid #ddd',\r\n              borderRadius:6,\r\n              padding:'10px 16px',\r\n              marginBottom:10,\r\n              boxShadow:activeStory?.id===s.id?'0 2px 8px #1976d233':'0 1px 2px #0001',\r\n              cursor:'pointer',\r\n              transition:'box-shadow 0.2s',\r\n              position:'relative'\r\n            }}\r\n            onClick={async ()=>{\r\n              // Fetch latest session to get up-to-date members and story state\r\n              const updatedSession = await sessionAPI.getSession(session.id);\r\n              const latestStory = updatedSession.stories.find(st => st.id === s.id) || s;\r\n              dispatch({type:'SET_ACTIVE',payload:latestStory});\r\n              dispatch({type:'SET',payload:{\r\n                votes: latestStory.votes || {},\r\n                isRevealed: !!latestStory.isRevealed,\r\n                session: { ...session, members: updatedSession.members }\r\n              }});\r\n            }}\r\n          >\r\n            <h4 style={{margin:'0 0 4px 0',fontWeight:600}}>{s.title}</h4>\r\n            {s.description && <p style={{margin:0,color:'#555'}}>{s.description}</p>}\r\n            {activeStory?.id===s.id && <span style={{position:'absolute',top:10,right:16,background:'#1976d2',color:'#fff',padding:'2px 8px',borderRadius:4,fontSize:12}}>Active</span>}\r\n            {/* No voting history UI, restored to original */}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}