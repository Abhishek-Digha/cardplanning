{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\abhis\\\\Downloads\\\\story-pointing-app\\\\frontend\\\\src\\\\contexts\\\\SessionContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { io } from 'socket.io-client';\nimport { sessionAPI } from '../utils/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SessionContext = /*#__PURE__*/createContext();\nconst initialState = {\n  session: null,\n  user: null,\n  socket: null,\n  stories: [],\n  activeStory: null,\n  votes: {},\n  voteCount: 0,\n  totalMembers: 0,\n  isRevealed: false\n};\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'SET':\n      return {\n        ...state,\n        ...action.payload\n      };\n    case 'ADD_MEMBER':\n      return {\n        ...state,\n        session: {\n          ...state.session,\n          members: [...state.session.members, action.payload]\n        }\n      };\n    case 'ADD_STORY':\n      return {\n        ...state,\n        stories: [...state.stories, action.payload]\n      };\n    case 'SET_ACTIVE':\n      return {\n        ...state,\n        activeStory: action.payload\n      };\n    case 'SET_VOTE_COUNT':\n      return {\n        ...state,\n        voteCount: action.payload.voteCount,\n        totalMembers: action.payload.totalMembers\n      };\n    case 'SET_VOTES':\n      return {\n        ...state,\n        votes: action.payload\n      };\n    case 'SET_REVEALED':\n      return {\n        ...state,\n        isRevealed: action.payload\n      };\n    case 'CLEAR_VOTES':\n      return {\n        ...state,\n        votes: {},\n        voteCount: 0,\n        isRevealed: false\n      };\n    default:\n      return state;\n  }\n}\nexport function SessionProvider({\n  children\n}) {\n  _s();\n  const [state, dispatch] = useReducer(reducer, initialState);\n  useEffect(() => {\n    const socket = io('http://localhost:5000');\n    dispatch({\n      type: 'SET',\n      payload: {\n        socket\n      }\n    });\n    socket.on('memberJoined', async () => {\n      var _state$session;\n      // Fetch latest session and update context for real-time members\n      if ((_state$session = state.session) !== null && _state$session !== void 0 && _state$session.id) {\n        const updatedSession = await sessionAPI.getSession(state.session.id);\n        dispatch({\n          type: 'SET',\n          payload: {\n            session: updatedSession,\n            stories: updatedSession.stories\n          }\n        });\n      }\n    });\n    socket.on('storyCreated', s => dispatch({\n      type: 'ADD_STORY',\n      payload: s\n    }));\n    socket.on('activeStoryChanged', id => {\n      const story = state.stories.find(s => s.id === id);\n      dispatch({\n        type: 'SET_ACTIVE',\n        payload: story\n      });\n    });\n    socket.on('voteCountChanged', async data => {\n      var _state$session2;\n      // Fetch latest session and update context for real-time votes and members\n      if ((_state$session2 = state.session) !== null && _state$session2 !== void 0 && _state$session2.id) {\n        const updatedSession = await sessionAPI.getSession(state.session.id);\n        dispatch({\n          type: 'SET',\n          payload: {\n            session: updatedSession,\n            stories: updatedSession.stories\n          }\n        });\n      }\n    });\n    socket.on('votesRevealed', data => {\n      dispatch({\n        type: 'SET_VOTES',\n        payload: data.votes\n      });\n      dispatch({\n        type: 'SET_REVEALED',\n        payload: true\n      });\n    });\n    socket.on('votesCleared', () => dispatch({\n      type: 'CLEAR_VOTES'\n    }));\n    return () => socket.disconnect();\n  }, [state.stories]);\n  return /*#__PURE__*/_jsxDEV(SessionContext.Provider, {\n    value: {\n      ...state,\n      dispatch\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n}\n_s(SessionProvider, \"gZZ3TaNWFnk5pxLxmdKGLDXNo7Y=\");\n_c = SessionProvider;\nexport function useSession() {\n  _s2();\n  return useContext(SessionContext);\n}\n_s2(useSession, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"SessionProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","io","sessionAPI","jsxDEV","_jsxDEV","SessionContext","initialState","session","user","socket","stories","activeStory","votes","voteCount","totalMembers","isRevealed","reducer","state","action","type","payload","members","SessionProvider","children","_s","dispatch","on","_state$session","id","updatedSession","getSession","s","story","find","data","_state$session2","disconnect","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useSession","_s2","$RefreshReg$"],"sources":["C:/Users/abhis/Downloads/story-pointing-app/frontend/src/contexts/SessionContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport { sessionAPI } from '../utils/api';\r\n\r\nconst SessionContext = createContext();\r\nconst initialState = {\r\n  session:null, user:null, socket:null,\r\n  stories:[], activeStory:null,\r\n  votes:{}, voteCount:0, totalMembers:0,\r\n  isRevealed:false\r\n};\r\n\r\nfunction reducer(state,action){\r\n  switch(action.type){\r\n    case 'SET': return {...state,...action.payload};\r\n    case 'ADD_MEMBER': return {\r\n      ...state,\r\n      session:{...state.session,members:[...state.session.members,action.payload]}\r\n    };\r\n    case 'ADD_STORY':\r\n      return {...state,stories:[...state.stories,action.payload]};\r\n    case 'SET_ACTIVE': return {...state,activeStory:action.payload};\r\n    case 'SET_VOTE_COUNT':\r\n      return {...state,voteCount:action.payload.voteCount,totalMembers:action.payload.totalMembers};\r\n    case 'SET_VOTES': return {...state,votes:action.payload};\r\n    case 'SET_REVEALED': return {...state,isRevealed:action.payload};\r\n    case 'CLEAR_VOTES':\r\n      return {...state,votes:{},voteCount:0,isRevealed:false};\r\n    default: return state;\r\n  }\r\n}\r\n\r\nexport function SessionProvider({children}){\r\n  const [state,dispatch] = useReducer(reducer,initialState);\r\n\r\n  useEffect(()=>{\r\n    const socket = io('http://localhost:5000');\r\n    dispatch({type:'SET',payload:{socket}});\r\n\r\n    socket.on('memberJoined',async()=>{\r\n      // Fetch latest session and update context for real-time members\r\n      if(state.session?.id) {\r\n        const updatedSession = await sessionAPI.getSession(state.session.id);\r\n        dispatch({type:'SET',payload:{session: updatedSession, stories: updatedSession.stories}});\r\n      }\r\n    });\r\n    socket.on('storyCreated',s=>dispatch({type:'ADD_STORY',payload:s}));\r\n    socket.on('activeStoryChanged',id=>{\r\n      const story = state.stories.find(s=>s.id===id);\r\n      dispatch({type:'SET_ACTIVE',payload:story});\r\n    });\r\n    socket.on('voteCountChanged',async data=>{\r\n      // Fetch latest session and update context for real-time votes and members\r\n      if(state.session?.id) {\r\n        const updatedSession = await sessionAPI.getSession(state.session.id);\r\n        dispatch({type:'SET',payload:{session: updatedSession, stories: updatedSession.stories}});\r\n      }\r\n    });\r\n    socket.on('votesRevealed',data=>{\r\n      dispatch({type:'SET_VOTES',payload:data.votes});\r\n      dispatch({type:'SET_REVEALED',payload:true});\r\n    });\r\n    socket.on('votesCleared',()=>dispatch({type:'CLEAR_VOTES'}));\r\n\r\n    return ()=>socket.disconnect();\r\n  },[state.stories]);\r\n\r\n  return (\r\n    <SessionContext.Provider value={{...state,dispatch}}>\r\n      {children}\r\n    </SessionContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useSession(){\r\n  return useContext(SessionContext);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}